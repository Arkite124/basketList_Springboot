<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.basketlist_springboot.Mapper.ProductMapper">
  <resultMap id="BaseResultMap" type="com.example.basketlist_springboot.Dto.Product">
    <id column="product_id" jdbcType="INTEGER" property="productId" />
    <result column="product_category" jdbcType="VARCHAR" property="productCategory" />
    <result column="product_name" jdbcType="VARCHAR" property="productName" />
    <result column="product_img_url" jdbcType="VARCHAR" property="productImgUrl" />
    <result column="product_description" jdbcType="VARCHAR" property="productDescription" />
    <result column="product_user_no" jdbcType="INTEGER" property="productUserNo" />
    <result column="product_price" jdbcType="INTEGER" property="productPrice"/>
    <result column="product_quantity" jdbcType="INTEGER" property="productQuantity"/>
    <result column="product_added_at" jdbcType="TIMESTAMP" property="productAddedAt"/>
  </resultMap>
  <select id="selectByProductId" parameterType="INTEGER" resultMap="BaseResultMap">
    select
    *
    from product
    where product_id = #{productId,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    select * from product order by PRODUCT_ADDED_AT DESC
  </select>
  <select id="selectByCategory" resultMap="BaseResultMap">
    select * from product where PRODUCT_CATEGORY=#{category,jdbcType=VARCHAR} order by PRODUCT_ADDED_AT DESC
  </select>
  <select id="selectProductListByProductUserNo" parameterType="integer" resultMap="BaseResultMap">
    select * from PRODUCT where PRODUCT_USER_NO=#{productUserNo,jdbcType=INTEGER} order by PRODUCT_ADDED_AT DESC
  </select>
  <delete id="deleteByProductIdAndProductUserNo" parameterType="map">
    delete from product
    where product_id = #{productId,jdbcType=INTEGER} and product_user_no=#{productUserNo,jdbcType=INTEGER}
  </delete>
  <insert id="insertProduct" keyColumn="product_id" keyProperty="productId" parameterType="com.example.basketlist_springboot.Dto.Product" useGeneratedKeys="true">
    insert into product (
      PRODUCT_CATEGORY,
PRODUCT_NAME,
PRODUCT_IMG_URL,
PRODUCT_DESCRIPTION,
PRODUCT_PRICE,
PRODUCT_USER_NO,
PRODUCT_QUANTITY)
    values (#{productCategory,jdbcType=VARCHAR}, #{productName,jdbcType=VARCHAR}, #{productImgUrl,jdbcType=VARCHAR},
      #{productDescription,jdbcType=VARCHAR},#{productPrice,jdbcType=INTEGER}, #{productUserNo,jdbcType=INTEGER},
            #{productQuantity,jdbcType=INTEGER})
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.example.basketlist_springboot.Dto.Product">
    update product
    <set>
      <if test="productCategory != null">
        product_category = #{productCategory,jdbcType=VARCHAR},
      </if>
      <if test="productName != null">
        product_name = #{productName,jdbcType=VARCHAR},
      </if>
      <if test="productImgUrl != null">
        product_img_url = #{productImgUrl,jdbcType=VARCHAR},
      </if>
      <if test="productDescription != null">
        product_description = #{productDescription,jdbcType=VARCHAR},
      </if>
      <if test="productUserNo != null">
        product_user_no = #{productUserNo,jdbcType=INTEGER},
      </if>
    </set>
    where product_id = #{productId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.example.basketlist_springboot.Dto.Product">
    update product
    set product_category = #{productCategory,jdbcType=VARCHAR},
      product_name = #{productName,jdbcType=VARCHAR},
      product_img_url = #{productImgUrl,jdbcType=VARCHAR},
      product_description = #{productDescription,jdbcType=VARCHAR},
      product_user_no = #{productUserNo,jdbcType=INTEGER}
    where product_id = #{productId,jdbcType=INTEGER}
  </update>
  <select id="selectByProductCategory" parameterType="java.lang.String" resultMap="BaseResultMap">
    select * from product where product_category=#{productCategory,jdbcType=VARCHAR}
  </select>
  <select id="selectByProductIdAndProductCategory" parameterType="map" resultMap="BaseResultMap">
    select * from product where product_id=#{productId} AND product_category=#{productCategory}
  </select>
  <select id="selectProductListLikeProductName" parameterType="java.lang.String" resultMap="BaseResultMap">
    select * from PRODUCT where PRODUCT_NAME like '%'||#{keyWord}||'%'
  </select>
</mapper>